{"code":"import { CurrencyAmount, Price } from '@uniswap/sdk-core';\r\nimport JSBI from 'jsbi';\r\nimport invariant from 'tiny-invariant';\r\nimport { FACTORY_ADDRESS, TICK_SPACINGS } from '../constants';\r\nimport { NEGATIVE_ONE, ONE, Q192, ZERO } from '../internalConstants';\r\nimport { computePoolAddress } from '../utils/computePoolAddress';\r\nimport { LiquidityMath } from '../utils/liquidityMath';\r\nimport { SwapMath } from '../utils/swapMath';\r\nimport { TickMath } from '../utils/tickMath';\r\nimport { NoTickDataProvider } from './tickDataProvider';\r\nimport { TickListDataProvider } from './tickListDataProvider';\r\n/**\r\n * By default, pools will not allow operations that require ticks.\r\n */\r\nconst NO_TICK_DATA_PROVIDER_DEFAULT = new NoTickDataProvider();\r\n/**\r\n * Represents a V3 pool\r\n */\r\nexport class Pool {\r\n    /**\r\n     * Construct a pool\r\n     * @param tokenA One of the tokens in the pool\r\n     * @param tokenB The other token in the pool\r\n     * @param fee The fee in hundredths of a bips of the input amount of every swap that is collected by the pool\r\n     * @param sqrtRatioX96 The sqrt of the current ratio of amounts of token1 to token0\r\n     * @param liquidity The current value of in range liquidity\r\n     * @param tickCurrent The current tick of the pool\r\n     * @param ticks The current state of the pool ticks or a data provider that can return tick data\r\n     */\r\n    constructor(tokenA, tokenB, fee, sqrtRatioX96, liquidity, tickCurrent, ticks = NO_TICK_DATA_PROVIDER_DEFAULT) {\r\n        invariant(Number.isInteger(fee) && fee < 1000000, 'FEE');\r\n        const tickCurrentSqrtRatioX96 = TickMath.getSqrtRatioAtTick(tickCurrent);\r\n        const nextTickSqrtRatioX96 = TickMath.getSqrtRatioAtTick(tickCurrent + 1);\r\n        invariant(JSBI.greaterThanOrEqual(JSBI.BigInt(sqrtRatioX96), tickCurrentSqrtRatioX96) &&\r\n            JSBI.lessThanOrEqual(JSBI.BigInt(sqrtRatioX96), nextTickSqrtRatioX96), 'PRICE_BOUNDS');\r\n        [this.token0, this.token1] = tokenA.sortsBefore(tokenB) ? [tokenA, tokenB] : [tokenB, tokenA];\r\n        this.fee = fee;\r\n        this.sqrtRatioX96 = JSBI.BigInt(sqrtRatioX96);\r\n        this.liquidity = JSBI.BigInt(liquidity);\r\n        this.tickCurrent = tickCurrent;\r\n        this.tickDataProvider = Array.isArray(ticks) ? new TickListDataProvider(ticks, TICK_SPACINGS[fee]) : ticks;\r\n    }\r\n    static getAddress(tokenA, tokenB, fee, initCodeHashManualOverride, factoryAddressOverride) {\r\n        return computePoolAddress({\r\n            factoryAddress: factoryAddressOverride ?? FACTORY_ADDRESS,\r\n            fee,\r\n            tokenA,\r\n            tokenB,\r\n            initCodeHashManualOverride\r\n        });\r\n    }\r\n    /**\r\n     * Returns true if the token is either token0 or token1\r\n     * @param token The token to check\r\n     * @returns True if token is either token0 or token\r\n     */\r\n    involvesToken(token) {\r\n        return token.equals(this.token0) || token.equals(this.token1);\r\n    }\r\n    /**\r\n     * Returns the current mid price of the pool in terms of token0, i.e. the ratio of token1 over token0\r\n     */\r\n    get token0Price() {\r\n        return (this._token0Price ??\r\n            (this._token0Price = new Price(this.token0, this.token1, Q192, JSBI.multiply(this.sqrtRatioX96, this.sqrtRatioX96))));\r\n    }\r\n    /**\r\n     * Returns the current mid price of the pool in terms of token1, i.e. the ratio of token0 over token1\r\n     */\r\n    get token1Price() {\r\n        return (this._token1Price ??\r\n            (this._token1Price = new Price(this.token1, this.token0, JSBI.multiply(this.sqrtRatioX96, this.sqrtRatioX96), Q192)));\r\n    }\r\n    /**\r\n     * Return the price of the given token in terms of the other token in the pool.\r\n     * @param token The token to return price of\r\n     * @returns The price of the given token, in terms of the other.\r\n     */\r\n    priceOf(token) {\r\n        invariant(this.involvesToken(token), 'TOKEN');\r\n        return token.equals(this.token0) ? this.token0Price : this.token1Price;\r\n    }\r\n    /**\r\n     * Returns the chain ID of the tokens in the pool.\r\n     */\r\n    get chainId() {\r\n        return this.token0.chainId;\r\n    }\r\n    /**\r\n     * Given an input amount of a token, return the computed output amount, and a pool with state updated after the trade\r\n     * @param inputAmount The input amount for which to quote the output amount\r\n     * @param sqrtPriceLimitX96 The Q64.96 sqrt price limit\r\n     * @returns The output amount and the pool with updated state\r\n     */\r\n    async getOutputAmount(inputAmount, sqrtPriceLimitX96) {\r\n        invariant(this.involvesToken(inputAmount.currency), 'TOKEN');\r\n        const zeroForOne = inputAmount.currency.equals(this.token0);\r\n        const { amountCalculated: outputAmount, sqrtRatioX96, liquidity, tickCurrent } = await this.swap(zeroForOne, inputAmount.quotient, sqrtPriceLimitX96);\r\n        const outputToken = zeroForOne ? this.token1 : this.token0;\r\n        return [\r\n            CurrencyAmount.fromRawAmount(outputToken, JSBI.multiply(outputAmount, NEGATIVE_ONE)),\r\n            new Pool(this.token0, this.token1, this.fee, sqrtRatioX96, liquidity, tickCurrent, this.tickDataProvider)\r\n        ];\r\n    }\r\n    /**\r\n     * Given a desired output amount of a token, return the computed input amount and a pool with state updated after the trade\r\n     * @param outputAmount the output amount for which to quote the input amount\r\n     * @param sqrtPriceLimitX96 The Q64.96 sqrt price limit. If zero for one, the price cannot be less than this value after the swap. If one for zero, the price cannot be greater than this value after the swap\r\n     * @returns The input amount and the pool with updated state\r\n     */\r\n    async getInputAmount(outputAmount, sqrtPriceLimitX96) {\r\n        invariant(outputAmount.currency.isToken && this.involvesToken(outputAmount.currency), 'TOKEN');\r\n        const zeroForOne = outputAmount.currency.equals(this.token1);\r\n        const { amountCalculated: inputAmount, sqrtRatioX96, liquidity, tickCurrent } = await this.swap(zeroForOne, JSBI.multiply(outputAmount.quotient, NEGATIVE_ONE), sqrtPriceLimitX96);\r\n        const inputToken = zeroForOne ? this.token0 : this.token1;\r\n        return [\r\n            CurrencyAmount.fromRawAmount(inputToken, inputAmount),\r\n            new Pool(this.token0, this.token1, this.fee, sqrtRatioX96, liquidity, tickCurrent, this.tickDataProvider)\r\n        ];\r\n    }\r\n    /**\r\n     * Executes a swap\r\n     * @param zeroForOne Whether the amount in is token0 or token1\r\n     * @param amountSpecified The amount of the swap, which implicitly configures the swap as exact input (positive), or exact output (negative)\r\n     * @param sqrtPriceLimitX96 The Q64.96 sqrt price limit. If zero for one, the price cannot be less than this value after the swap. If one for zero, the price cannot be greater than this value after the swap\r\n     * @returns amountCalculated\r\n     * @returns sqrtRatioX96\r\n     * @returns liquidity\r\n     * @returns tickCurrent\r\n     */\r\n    async swap(zeroForOne, amountSpecified, sqrtPriceLimitX96) {\r\n        if (!sqrtPriceLimitX96)\r\n            sqrtPriceLimitX96 = zeroForOne\r\n                ? JSBI.add(TickMath.MIN_SQRT_RATIO, ONE)\r\n                : JSBI.subtract(TickMath.MAX_SQRT_RATIO, ONE);\r\n        if (zeroForOne) {\r\n            invariant(JSBI.greaterThan(sqrtPriceLimitX96, TickMath.MIN_SQRT_RATIO), 'RATIO_MIN');\r\n            invariant(JSBI.lessThan(sqrtPriceLimitX96, this.sqrtRatioX96), 'RATIO_CURRENT');\r\n        }\r\n        else {\r\n            invariant(JSBI.lessThan(sqrtPriceLimitX96, TickMath.MAX_SQRT_RATIO), 'RATIO_MAX');\r\n            invariant(JSBI.greaterThan(sqrtPriceLimitX96, this.sqrtRatioX96), 'RATIO_CURRENT');\r\n        }\r\n        const exactInput = JSBI.greaterThanOrEqual(amountSpecified, ZERO);\r\n        // keep track of swap state\r\n        const state = {\r\n            amountSpecifiedRemaining: amountSpecified,\r\n            amountCalculated: ZERO,\r\n            sqrtPriceX96: this.sqrtRatioX96,\r\n            tick: this.tickCurrent,\r\n            liquidity: this.liquidity\r\n        };\r\n        // start swap while loop\r\n        while (JSBI.notEqual(state.amountSpecifiedRemaining, ZERO) && state.sqrtPriceX96 != sqrtPriceLimitX96) {\r\n            let step = {};\r\n            step.sqrtPriceStartX96 = state.sqrtPriceX96;\r\n            [step.tickNext, step.initialized] = await this.tickDataProvider.nextInitializedTickWithinOneWord(state.tick, zeroForOne, this.tickSpacing);\r\n            if (step.tickNext < TickMath.MIN_TICK) {\r\n                step.tickNext = TickMath.MIN_TICK;\r\n            }\r\n            else if (step.tickNext > TickMath.MAX_TICK) {\r\n                step.tickNext = TickMath.MAX_TICK;\r\n            }\r\n            step.sqrtPriceNextX96 = TickMath.getSqrtRatioAtTick(step.tickNext);\r\n            [state.sqrtPriceX96, step.amountIn, step.amountOut, step.feeAmount] = SwapMath.computeSwapStep(state.sqrtPriceX96, (zeroForOne\r\n                ? JSBI.lessThan(step.sqrtPriceNextX96, sqrtPriceLimitX96)\r\n                : JSBI.greaterThan(step.sqrtPriceNextX96, sqrtPriceLimitX96))\r\n                ? sqrtPriceLimitX96\r\n                : step.sqrtPriceNextX96, state.liquidity, state.amountSpecifiedRemaining, this.fee);\r\n            if (exactInput) {\r\n                state.amountSpecifiedRemaining = JSBI.subtract(state.amountSpecifiedRemaining, JSBI.add(step.amountIn, step.feeAmount));\r\n                state.amountCalculated = JSBI.subtract(state.amountCalculated, step.amountOut);\r\n            }\r\n            else {\r\n                state.amountSpecifiedRemaining = JSBI.add(state.amountSpecifiedRemaining, step.amountOut);\r\n                state.amountCalculated = JSBI.add(state.amountCalculated, JSBI.add(step.amountIn, step.feeAmount));\r\n            }\r\n            // TODO\r\n            if (JSBI.equal(state.sqrtPriceX96, step.sqrtPriceNextX96)) {\r\n                // if the tick is initialized, run the tick transition\r\n                if (step.initialized) {\r\n                    let liquidityNet = JSBI.BigInt((await this.tickDataProvider.getTick(step.tickNext)).liquidityNet);\r\n                    // if we're moving leftward, we interpret liquidityNet as the opposite sign\r\n                    // safe because liquidityNet cannot be type(int128).min\r\n                    if (zeroForOne)\r\n                        liquidityNet = JSBI.multiply(liquidityNet, NEGATIVE_ONE);\r\n                    state.liquidity = LiquidityMath.addDelta(state.liquidity, liquidityNet);\r\n                }\r\n                state.tick = zeroForOne ? step.tickNext - 1 : step.tickNext;\r\n            }\r\n            else if (JSBI.notEqual(state.sqrtPriceX96, step.sqrtPriceStartX96)) {\r\n                // updated comparison function\r\n                // recompute unless we're on a lower tick boundary (i.e. already transitioned ticks), and haven't moved\r\n                state.tick = TickMath.getTickAtSqrtRatio(state.sqrtPriceX96);\r\n            }\r\n        }\r\n        return {\r\n            amountCalculated: state.amountCalculated,\r\n            sqrtRatioX96: state.sqrtPriceX96,\r\n            liquidity: state.liquidity,\r\n            tickCurrent: state.tick\r\n        };\r\n    }\r\n    get tickSpacing() {\r\n        return TICK_SPACINGS[this.fee];\r\n    }\r\n}\r\n//# sourceMappingURL=pool.js.map","references":["/Users/luozhiwei/project/uniswap/v3-sdk/node_modules/@uniswap/sdk-core/dist/index.d.ts","/Users/luozhiwei/project/uniswap/v3-sdk/node_modules/jsbi/jsbi.d.ts","/Users/luozhiwei/project/uniswap/v3-sdk/node_modules/tiny-invariant/dist/tiny-invariant.d.ts","/Users/luozhiwei/project/uniswap/v3-sdk/src/constants.ts","/Users/luozhiwei/project/uniswap/v3-sdk/src/internalConstants.ts","/Users/luozhiwei/project/uniswap/v3-sdk/src/utils/computePoolAddress.ts","/Users/luozhiwei/project/uniswap/v3-sdk/src/utils/liquidityMath.ts","/Users/luozhiwei/project/uniswap/v3-sdk/src/utils/swapMath.ts","/Users/luozhiwei/project/uniswap/v3-sdk/src/utils/tickMath.ts","/Users/luozhiwei/project/uniswap/v3-sdk/src/entities/tick.ts","/Users/luozhiwei/project/uniswap/v3-sdk/src/entities/tickDataProvider.ts","/Users/luozhiwei/project/uniswap/v3-sdk/src/entities/tickListDataProvider.ts"],"map":"{\"version\":3,\"file\":\"pool.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/entities/pool.ts\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/Users/luozhiwei/project/uniswap/v3-sdk/entities/pool.d.ts","writeByteOrderMark":false,"text":"import { BigintIsh, CurrencyAmount, Price, Token } from '@uniswap/sdk-core';\r\nimport JSBI from 'jsbi';\r\nimport { FeeAmount } from '../constants';\r\nimport { Tick, TickConstructorArgs } from './tick';\r\nimport { TickDataProvider } from './tickDataProvider';\r\n/**\r\n * Represents a V3 pool\r\n */\r\nexport declare class Pool {\r\n    readonly token0: Token;\r\n    readonly token1: Token;\r\n    readonly fee: FeeAmount;\r\n    readonly sqrtRatioX96: JSBI;\r\n    readonly liquidity: JSBI;\r\n    readonly tickCurrent: number;\r\n    readonly tickDataProvider: TickDataProvider;\r\n    private _token0Price?;\r\n    private _token1Price?;\r\n    static getAddress(tokenA: Token, tokenB: Token, fee: FeeAmount, initCodeHashManualOverride?: string, factoryAddressOverride?: string): string;\r\n    /**\r\n     * Construct a pool\r\n     * @param tokenA One of the tokens in the pool\r\n     * @param tokenB The other token in the pool\r\n     * @param fee The fee in hundredths of a bips of the input amount of every swap that is collected by the pool\r\n     * @param sqrtRatioX96 The sqrt of the current ratio of amounts of token1 to token0\r\n     * @param liquidity The current value of in range liquidity\r\n     * @param tickCurrent The current tick of the pool\r\n     * @param ticks The current state of the pool ticks or a data provider that can return tick data\r\n     */\r\n    constructor(tokenA: Token, tokenB: Token, fee: FeeAmount, sqrtRatioX96: BigintIsh, liquidity: BigintIsh, tickCurrent: number, ticks?: TickDataProvider | (Tick | TickConstructorArgs)[]);\r\n    /**\r\n     * Returns true if the token is either token0 or token1\r\n     * @param token The token to check\r\n     * @returns True if token is either token0 or token\r\n     */\r\n    involvesToken(token: Token): boolean;\r\n    /**\r\n     * Returns the current mid price of the pool in terms of token0, i.e. the ratio of token1 over token0\r\n     */\r\n    get token0Price(): Price<Token, Token>;\r\n    /**\r\n     * Returns the current mid price of the pool in terms of token1, i.e. the ratio of token0 over token1\r\n     */\r\n    get token1Price(): Price<Token, Token>;\r\n    /**\r\n     * Return the price of the given token in terms of the other token in the pool.\r\n     * @param token The token to return price of\r\n     * @returns The price of the given token, in terms of the other.\r\n     */\r\n    priceOf(token: Token): Price<Token, Token>;\r\n    /**\r\n     * Returns the chain ID of the tokens in the pool.\r\n     */\r\n    get chainId(): number;\r\n    /**\r\n     * Given an input amount of a token, return the computed output amount, and a pool with state updated after the trade\r\n     * @param inputAmount The input amount for which to quote the output amount\r\n     * @param sqrtPriceLimitX96 The Q64.96 sqrt price limit\r\n     * @returns The output amount and the pool with updated state\r\n     */\r\n    getOutputAmount(inputAmount: CurrencyAmount<Token>, sqrtPriceLimitX96?: JSBI): Promise<[CurrencyAmount<Token>, Pool]>;\r\n    /**\r\n     * Given a desired output amount of a token, return the computed input amount and a pool with state updated after the trade\r\n     * @param outputAmount the output amount for which to quote the input amount\r\n     * @param sqrtPriceLimitX96 The Q64.96 sqrt price limit. If zero for one, the price cannot be less than this value after the swap. If one for zero, the price cannot be greater than this value after the swap\r\n     * @returns The input amount and the pool with updated state\r\n     */\r\n    getInputAmount(outputAmount: CurrencyAmount<Token>, sqrtPriceLimitX96?: JSBI): Promise<[CurrencyAmount<Token>, Pool]>;\r\n    /**\r\n     * Executes a swap\r\n     * @param zeroForOne Whether the amount in is token0 or token1\r\n     * @param amountSpecified The amount of the swap, which implicitly configures the swap as exact input (positive), or exact output (negative)\r\n     * @param sqrtPriceLimitX96 The Q64.96 sqrt price limit. If zero for one, the price cannot be less than this value after the swap. If one for zero, the price cannot be greater than this value after the swap\r\n     * @returns amountCalculated\r\n     * @returns sqrtRatioX96\r\n     * @returns liquidity\r\n     * @returns tickCurrent\r\n     */\r\n    private swap;\r\n    get tickSpacing(): number;\r\n}\r\n"}}
