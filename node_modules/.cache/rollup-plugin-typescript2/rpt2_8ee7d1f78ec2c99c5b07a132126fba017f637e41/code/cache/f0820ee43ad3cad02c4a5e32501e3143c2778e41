{"code":"import invariant from 'tiny-invariant';\r\nimport { Price, wrappedCurrency } from '@uniswap/sdk-core';\r\n/**\r\n * Represents a list of pools through which a swap can occur\r\n */\r\nexport class Route {\r\n    constructor(pools, input, output) {\r\n        this._midPrice = null;\r\n        invariant(pools.length > 0, 'POOLS');\r\n        const chainId = pools[0].chainId;\r\n        const allOnSameChain = pools.every(pool => pool.chainId === chainId);\r\n        invariant(allOnSameChain, 'CHAIN_IDS');\r\n        const wrappedInput = wrappedCurrency(input, chainId);\r\n        invariant(pools[0].involvesToken(wrappedInput), 'INPUT');\r\n        invariant(pools[pools.length - 1].involvesToken(wrappedCurrency(output, chainId)), 'OUTPUT');\r\n        /**\r\n         * Normalizes token0-token1 order and selects the next token/fee step to add to the path\r\n         * */\r\n        const tokenPath = [wrappedInput];\r\n        for (const [i, pool] of pools.entries()) {\r\n            const currentInputToken = tokenPath[i];\r\n            invariant(currentInputToken.equals(pool.token0) || currentInputToken.equals(pool.token1), 'PATH');\r\n            const nextToken = currentInputToken.equals(pool.token0) ? pool.token1 : pool.token0;\r\n            tokenPath.push(nextToken);\r\n        }\r\n        this.pools = pools;\r\n        this.tokenPath = tokenPath;\r\n        this.input = input;\r\n        this.output = output ?? tokenPath[tokenPath.length - 1];\r\n    }\r\n    get chainId() {\r\n        return this.pools[0].chainId;\r\n    }\r\n    /**\r\n     * Returns the token representation of the input currency. If the input currency is Ether, returns the wrapped ether token.\r\n     */\r\n    get inputToken() {\r\n        return wrappedCurrency(this.input, this.chainId);\r\n    }\r\n    /**\r\n     * Returns the token representation of the output currency. If the output currency is Ether, returns the wrapped ether token.\r\n     */\r\n    get outputToken() {\r\n        return wrappedCurrency(this.output, this.chainId);\r\n    }\r\n    /**\r\n     * Returns the mid price of the route\r\n     */\r\n    get midPrice() {\r\n        if (this._midPrice !== null)\r\n            return this._midPrice;\r\n        const price = this.pools.slice(1).reduce(({ nextInput, price }, pool) => {\r\n            return nextInput.equals(pool.token0)\r\n                ? {\r\n                    nextInput: pool.token1,\r\n                    price: price.multiply(pool.token0Price)\r\n                }\r\n                : {\r\n                    nextInput: pool.token0,\r\n                    price: price.multiply(pool.token1Price)\r\n                };\r\n        }, this.pools[0].token0.equals(this.inputToken)\r\n            ? {\r\n                nextInput: this.pools[0].token1,\r\n                price: this.pools[0].token0Price\r\n            }\r\n            : {\r\n                nextInput: this.pools[0].token0,\r\n                price: this.pools[0].token1Price\r\n            }).price;\r\n        return (this._midPrice = new Price(this.input, this.output, price.denominator, price.numerator));\r\n    }\r\n}\r\n//# sourceMappingURL=route.js.map","references":["/Users/luozhiwei/project/uniswap/v3-sdk-3.0.0-alpha.6/node_modules/tiny-invariant/dist/tiny-invariant.d.ts","/Users/luozhiwei/project/uniswap/v3-sdk-3.0.0-alpha.6/node_modules/@uniswap/sdk-core/dist/index.d.ts","/Users/luozhiwei/project/uniswap/v3-sdk-3.0.0-alpha.6/src/entities/pool.ts"],"map":"{\"version\":3,\"file\":\"route.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/entities/route.ts\"],\"names\":[],\"mappings\":\"AAAA,OAAO,SAAS,MAAM,gBAAgB,CAAA;AAEtC,OAAO,EAAqB,KAAK,EAAS,eAAe,EAAE,MAAM,mBAAmB,CAAA;AAGpF;;GAEG;AACH,MAAM,OAAO,KAAK;IAQhB,YAAmB,KAAa,EAAE,KAAa,EAAE,MAAe;QAFxD,cAAS,GAAkC,IAAI,CAAA;QAGrD,SAAS,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE,OAAO,CAAC,CAAA;QAEpC,MAAM,OAAO,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAA;QAChC,MAAM,cAAc,GAAG,KAAK,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,KAAK,OAAO,CAAC,CAAA;QACpE,SAAS,CAAC,cAAc,EAAE,WAAW,CAAC,CAAA;QAEtC,MAAM,YAAY,GAAG,eAAe,CAAC,KAAK,EAAE,OAAO,CAAC,CAAA;QACpD,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,aAAa,CAAC,YAAY,CAAC,EAAE,OAAO,CAAC,CAAA;QAExD,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,aAAa,CAAC,eAAe,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC,EAAE,QAAQ,CAAC,CAAA;QAE5F;;aAEK;QACL,MAAM,SAAS,GAAY,CAAC,YAAY,CAAC,CAAA;QACzC,KAAK,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,KAAK,CAAC,OAAO,EAAE,EAAE;YACvC,MAAM,iBAAiB,GAAG,SAAS,CAAC,CAAC,CAAC,CAAA;YACtC,SAAS,CAAC,iBAAiB,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,iBAAiB,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,MAAM,CAAC,CAAA;YACjG,MAAM,SAAS,GAAG,iBAAiB,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAA;YACnF,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,CAAA;SAC1B;QAED,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QAClB,IAAI,CAAC,SAAS,GAAG,SAAS,CAAA;QAC1B,IAAI,CAAC,KAAK,GAAG,KAAK,CAAA;QAClB,IAAI,CAAC,MAAM,GAAG,MAAM,IAAI,SAAS,CAAC,SAAS,CAAC,MAAM,GAAG,CAAC,CAAC,CAAA;IACzD,CAAC;IAED,IAAW,OAAO;QAChB,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,OAAO,CAAA;IAC9B,CAAC;IAED;;OAEG;IACH,IAAW,UAAU;QACnB,OAAO,eAAe,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;IAClD,CAAC;IAED;;OAEG;IACH,IAAW,WAAW;QACpB,OAAO,eAAe,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,OAAO,CAAC,CAAA;IACnD,CAAC;IAED;;OAEG;IACH,IAAW,QAAQ;QACjB,IAAI,IAAI,CAAC,SAAS,KAAK,IAAI;YAAE,OAAO,IAAI,CAAC,SAAS,CAAA;QAElD,MAAM,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CACtC,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,EAAE;YAC7B,OAAO,SAAS,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC;gBAClC,CAAC,CAAC;oBACE,SAAS,EAAE,IAAI,CAAC,MAAM;oBACtB,KAAK,EAAE,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC;iBACxC;gBACH,CAAC,CAAC;oBACE,SAAS,EAAE,IAAI,CAAC,MAAM;oBACtB,KAAK,EAAE,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC;iBACxC,CAAA;QACP,CAAC,EACD,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YAC1C,CAAC,CAAC;gBACE,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM;gBAC/B,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,WAAW;aACjC;YACH,CAAC,CAAC;gBACE,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM;gBAC/B,KAAK,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,WAAW;aACjC,CACN,CAAC,KAAK,CAAA;QAEP,OAAO,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,KAAK,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,MAAM,EAAE,KAAK,CAAC,WAAW,EAAE,KAAK,CAAC,SAAS,CAAC,CAAC,CAAA;IAClG,CAAC;CACF\"}"}
